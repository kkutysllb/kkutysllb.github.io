<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png?v=7.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="lsof：查看进程打开的文件lsof全名为list open files，也就是列举系统中已经被打开的文件，通过lsof命令，就可以根据文件找到对应的进程信息，也可以根据进程信息找到进程打开的文件。">
<meta name="keywords" content="Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="2019-05-27-Linux系统命令-第十篇《系统管理命令》">
<meta property="og:url" content="https://kkutysllb.cn/2019/05/27/2019-05-27-Linux系统命令-第十篇《系统管理命令》/index.html">
<meta property="og:site_name" content="一花一菩提，一云一世界">
<meta property="og:description" content="lsof：查看进程打开的文件lsof全名为list open files，也就是列举系统中已经被打开的文件，通过lsof命令，就可以根据文件找到对应的进程信息，也可以根据进程信息找到进程打开的文件。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb398a4a0c461158.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3b0dcbba119224.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3b7b2821539240.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3ba4db46537601.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3bdb6a02c59773.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3bfc5d87271319.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3ccb675ce10702.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3d27f0cb984707.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3dd50f76288111.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3dfba05f727072.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3e2aa200578443.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3f2f7bcc312594.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3f56f2f2286102.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb3f77ab40292709.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb4053ebcb844502.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb406c42a6f39618.jpg">
<meta property="og:image" content="https://i.loli.net/2019/05/27/5ceb408073af029814.jpg">
<meta property="og:updated_time" content="2019-05-27T02:15:25.580Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2019-05-27-Linux系统命令-第十篇《系统管理命令》">
<meta name="twitter:description" content="lsof：查看进程打开的文件lsof全名为list open files，也就是列举系统中已经被打开的文件，通过lsof命令，就可以根据文件找到对应的进程信息，也可以根据进程信息找到进程打开的文件。">
<meta name="twitter:image" content="https://i.loli.net/2019/05/27/5ceb398a4a0c461158.jpg">



  <link rel="alternate" href="/atom.xml" title="一花一菩提，一云一世界" type="application/atom+xml">




  <link rel="canonical" href="https://kkutysllb.cn/2019/05/27/2019-05-27-Linux系统命令-第十篇《系统管理命令》/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>2019-05-27-Linux系统命令-第十篇《系统管理命令》 | 一花一菩提，一云一世界</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?45d7282259ecad100b2fe7e379853e80";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一花一菩提，一云一世界</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">佛系ICT人士技术博客</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://kkutysllb.cn/2019/05/27/2019-05-27-Linux系统命令-第十篇《系统管理命令》/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="kkutysllb">
      <meta itemprop="description" content="容易走的路是下坡路<br>总是不经意间装个X得罪一票人">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一花一菩提，一云一世界">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2019-05-27-Linux系统命令-第十篇《系统管理命令》

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-27 09:11:32 / 修改时间：10:15:25" itemprop="dateCreated datePublished" datetime="2019-05-27T09:11:32+08:00">2019-05-27</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux核心命令/" itemprop="url" rel="index"><span itemprop="name">Linux核心命令</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">46k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">42 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="lsof：查看进程打开的文件"><a href="#lsof：查看进程打开的文件" class="headerlink" title="lsof：查看进程打开的文件"></a>lsof：查看进程打开的文件</h2><p>lsof全名为list open files，也就是列举系统中已经被打开的文件，通过lsof命令，就可以根据文件找到对应的进程信息，也可以根据进程信息找到进程打开的文件。<a id="more"></a></p>
<p><strong>语法格式：lsof [option]</strong></p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb398a4a0c461158.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）显示使用文件的进程</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示使用/var/log/message文件的进程信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof /var/log/messages </span></span><br><span class="line">COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF      NODE NAME</span><br><span class="line">rsyslogd 1039 root    6w   REG    8,3   782990 101157938 /var/<span class="built_in">log</span>/messages</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>如果想知道文件是被哪个进程所使用，直接lsof+文件名就可以查询。</strong></p>
<p><strong>上述结果的说明如下：</strong></p>
<p><strong>COMMAND：</strong>命令，进程的名称。</p>
<p><strong>PID：</strong>进程号。</p>
<p><strong>USER：</strong>进程的所有者。</p>
<p><strong>FD：</strong>文件描述符，它又包含如下内容。</p>
<p>​    <strong>0：</strong>表示标准输出。</p>
<p>​    <strong>1：</strong>表示标准输入。</p>
<p>​    <strong>2：</strong>表示标准错误。</p>
<p>​    <strong>u：</strong>表示该文件被打开并处于读取/写入模式。</p>
<p>​    <strong>r：</strong>表示该文件被打开并处于只读模式。</p>
<p>​    <strong>w：</strong>表示该文件被打开并处于写入模式。</p>
<p><strong>TYPE：</strong>文件类型，REG（regular）为普通文件。</p>
<p><strong>DEVICE：</strong>指定磁盘的标识。</p>
<p><strong>SIZE/OFF：</strong>文件的大小。</p>
<p><strong>NODE：</strong>索引节点。</p>
<p><strong>NAME：</strong>文件名称。进程号。</p>
<p><strong>USER：</strong>进程的所有者。</p>
<p><strong>FD：</strong>文件描述符，它又包含如下内容。</p>
<p>​    <strong>0：</strong>表示标准输出。</p>
<p>​    <strong>1：</strong>表示标准输入。</p>
<p>​    <strong>2：</strong>表示标准错误。</p>
<p>​    <strong>u：</strong>表示该文件被打开并处于读取/写入模式。</p>
<p>​    <strong>r：</strong>表示该文件被打开并处于只读模式。</p>
<p>​    <strong>w：</strong>表示该文件被打开并处于写入模式。</p>
<p><strong>TYPE：</strong>文件类型，REG（regular）为普通文件。</p>
<p><strong>DEVICE：</strong>指定磁盘的标识。</p>
<p><strong>SIZE/OFF：</strong>文件的大小。</p>
<p><strong>NODE：</strong>索引节点。</p>
<p><strong>NAME：</strong>文件名称。</p>
</blockquote>
<p><strong>2）显示指定进程所打开的文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过-c选项指定进程名</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -c crond</span></span><br><span class="line">COMMAND PID USER   FD      TYPE             DEVICE  SIZE/OFF      NODE NAME</span><br><span class="line">crond   671 root  cwd       DIR                8,3       224        64 /</span><br><span class="line">crond   671 root  rtd       DIR                8,3       224        64 /</span><br><span class="line">crond   671 root  txt       REG                8,3     70128    462795 /usr/sbin/crond</span><br><span class="line">crond   671 root  mem       REG                8,3     62184      1900 /usr/lib64/libnss_files-2.17.so</span><br><span class="line">crond   671 root  mem       REG                8,3 106070960 100665267 /usr/lib/locale/locale-archive</span><br><span class="line">crond   671 root  mem       REG                8,3    144792      1908 /usr/lib64/libpthread-2.17.so</span><br><span class="line">crond   671 root  mem       REG                8,3     23968      2361 /usr/lib64/libcap-ng.so.0.0.0</span><br><span class="line">crond   671 root  mem       REG                8,3    402384      2006 /usr/lib64/libpcre.so.1.2.0</span><br><span class="line">crond   671 root  mem       REG                8,3   2173512      1882 /usr/lib64/libc-2.17.so</span><br><span class="line">crond   671 root  mem       REG                8,3    127184      2359 /usr/lib64/libaudit.so.1.0.0</span><br><span class="line">crond   671 root  mem       REG                8,3     19776      1888 /usr/lib64/libdl-2.17.so</span><br><span class="line">crond   671 root  mem       REG                8,3     61672      3998 /usr/lib64/libpam.so.0.83.1</span><br><span class="line">crond   671 root  mem       REG                8,3    155784    190119 /usr/lib64/libselinux.so.1</span><br><span class="line">crond   671 root  mem       REG                8,3    164240      1875 /usr/lib64/ld-2.17.so</span><br><span class="line">crond   671 root    0r      CHR                1,3       0t0      1028 /dev/null</span><br><span class="line">crond   671 root    1u     unix 0xffff9fd574eca800       0t0     23970 socket</span><br><span class="line">crond   671 root    2u     unix 0xffff9fd574eca800       0t0     23970 socket</span><br><span class="line">crond   671 root    3uW     REG               0,20         4     23971 /run/crond.pid</span><br><span class="line">crond   671 root    4u     unix 0xffff9fd574e3f800       0t0     25637 socket</span><br><span class="line">crond   671 root    5r  a_inode               0,10         0      8261 inotify</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过-p选项指定进程号</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -p 1105</span></span><br><span class="line">COMMAND  PID   USER   FD      TYPE             DEVICE SIZE/OFF      NODE NAME</span><br><span class="line">httpd   1105 apache  cwd       DIR                8,3      224        64 /</span><br><span class="line">httpd   1105 apache  rtd       DIR                8,3      224        64 /</span><br><span class="line">httpd   1105 apache  txt       REG                8,3   523672   5947365 /usr/sbin/httpd</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    62184      1900 /usr/lib64/libnss_files-2.17.so</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    27808  68422763 /usr/lib64/httpd/modules/mod_cgi.so</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    68192      2275 /usr/lib64/libbz2.so.1.0.6</span><br><span class="line">httpd   1105 apache  mem       REG                8,3   157424      2265 /usr/lib64/liblzma.so.5.2.2</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    99944      2264 /usr/lib64/libelf-0.170.so</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    19896      1993 /usr/lib64/libattr.so.1.1.0</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    88720        84 /usr/lib64/libgcc_s-4.8.5-20150702.so.1</span><br><span class="line">httpd   1105 apache  mem       REG                8,3   297360    193704 /usr/lib64/libdw-0.170.so</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    20032      1998 /usr/lib64/libcap.so.2.22</span><br><span class="line">httpd   1105 apache  mem       REG                8,3    44448      1912 /usr/lib64/librt-2.17.so</span><br><span class="line">。。。</span><br></pre></td></tr></table></figure>
<p><strong>3）监听指定的协议、端口和主机等信息，显示符合条件的网络服务进程</strong></p>
<p><strong>语法格式：lsof -i [46] [protocol][@hostname][:service|port]</strong></p>
<blockquote>
<p><strong>说明如下：</strong></p>
<p>46：4代表IPv4，6代表IPv6。</p>
<p>protocol：传输协议，可以是TCP或UDP。</p>
<p>hostname：主机名称或者IP地址。</p>
<p>service：进程的服务名，例如NFS、SSH和FTP等。</p>
<p>port：系统中与服务对应的端口号。例如HTTP服务默认对应的端口号为80，SSH服务默认对应的端口号为22。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有网络服务进程</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -i</span></span><br><span class="line">COMMAND    PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">systemd      1   root   48u  IPv6  42537      0t0  TCP *:telnet (LISTEN)</span><br><span class="line">chronyd    645 chrony    1u  IPv4  22341      0t0  UDP localhost:323 </span><br><span class="line">chronyd    645 chrony    2u  IPv6  22342      0t0  UDP localhost:323 </span><br><span class="line">sshd      1038   root    3u  IPv4  26920      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">sshd      1038   root    4u  IPv6  26929      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">httpd     1042   root    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1101 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1102 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1103 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1104 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1105 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">master    1310   root   13u  IPv4  24294      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">master    1310   root   14u  IPv6  24295      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">docker-pr 1648   root    4u  IPv6  24517      0t0  TCP *:terabase (LISTEN)</span><br><span class="line">sshd      1736   root    3u  IPv4  29038      0t0  TCP C7-Server01:ssh-&gt;192.168.101.1:servicetags (ESTABLISHED)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有tcp连接进程</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -i tcp</span></span><br><span class="line">COMMAND    PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">systemd      1   root   48u  IPv6  42537      0t0  TCP *:telnet (LISTEN)</span><br><span class="line">sshd      1038   root    3u  IPv4  26920      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">sshd      1038   root    4u  IPv6  26929      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">httpd     1042   root    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1101 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1102 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1103 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1104 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1105 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">master    1310   root   13u  IPv4  24294      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">master    1310   root   14u  IPv6  24295      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">docker-pr 1648   root    4u  IPv6  24517      0t0  TCP *:terabase (LISTEN)</span><br><span class="line">sshd      1736   root    3u  IPv4  29038      0t0  TCP C7-Server01:ssh-&gt;192.168.101.1:servicetags (ESTABLISHED)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示端口号为22的网络服务进程</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -i :22</span></span><br><span class="line">COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">sshd    1038 root    3u  IPv4  26920      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">sshd    1038 root    4u  IPv6  26929      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">sshd    1736 root    3u  IPv4  29038      0t0  TCP C7-Server01:ssh-&gt;192.168.101.1:servicetags (ESTABLISHED)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有支持ipv6的进程</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -i 6</span></span><br><span class="line">COMMAND    PID   USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">systemd      1   root   48u  IPv6  42537      0t0  TCP *:telnet (LISTEN)</span><br><span class="line">chronyd    645 chrony    2u  IPv6  22342      0t0  UDP localhost:323 </span><br><span class="line">sshd      1038   root    4u  IPv6  26929      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">httpd     1042   root    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1101 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1102 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1103 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1104 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">httpd     1105 apache    4u  IPv6  27020      0t0  TCP *:http (LISTEN)</span><br><span class="line">master    1310   root   14u  IPv6  24295      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">docker-pr 1648   root    4u  IPv6  24517      0t0  TCP *:terabase (LISTEN)</span><br></pre></td></tr></table></figure>
<p><strong>3）显示指定用户使用的文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-u选项，显示chrony用户使用的文件</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -u chrony</span></span><br><span class="line">COMMAND PID   USER   FD   TYPE             DEVICE SIZE/OFF   NODE NAME</span><br><span class="line">chronyd 645 chrony  cwd    DIR                8,3      224     64 /</span><br><span class="line">chronyd 645 chrony  rtd    DIR                8,3      224     64 /</span><br><span class="line">chronyd 645 chrony  txt    REG                8,3   261024 466082 /usr/sbin/chronyd</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   547568   1239 /usr/lib64/libfreeblpriv3.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    68192   2275 /usr/lib64/libbz2.so.1.0.6</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   157424   2265 /usr/lib64/liblzma.so.5.2.2</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    90248 190122 /usr/lib64/libz.so.1.2.7</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    99944   2264 /usr/lib64/libelf-0.170.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    88720     84 /usr/lib64/libgcc_s-4.8.5-20150702.so.1</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   297360 193704 /usr/lib64/libdw-0.170.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    44448   1912 /usr/lib64/librt-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    86544 193707 /usr/lib64/libnss_myhostname.so.2</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   106848   1910 /usr/lib64/libresolv-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    31824   1898 /usr/lib64/libnss_dns-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    62184   1900 /usr/lib64/libnss_files-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    19896   1993 /usr/lib64/libattr.so.1.1.0</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    19776   1888 /usr/lib64/libdl-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3  2173512   1882 /usr/lib64/libc-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   144792   1908 /usr/lib64/libpthread-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   266680  86207 /usr/lib64/libseccomp.so.2.3.1</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    20032   1998 /usr/lib64/libcap.so.2.22</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3    11464   1237 /usr/lib64/libfreebl3.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3  1139680   1890 /usr/lib64/libm-2.17.so</span><br><span class="line">chronyd 645 chrony  mem    REG                8,3   164240   1875 /usr/lib64/ld-2.17.so</span><br><span class="line">chronyd 645 chrony    0u  unix 0xffff9fd57f8d7000      0t0  22339 socket</span><br><span class="line">chronyd 645 chrony    1u  IPv4              22341      0t0    UDP localhost:323 </span><br><span class="line">chronyd 645 chrony    2u  IPv6              22342      0t0    UDP localhost:323 </span><br><span class="line">chronyd 645 chrony    3r   CHR                1,9      0t0   1033 /dev/urandom</span><br><span class="line">chronyd 645 chrony    5u  unix 0xffff9fd57f8d6c00      0t0  22347 /var/run/chrony/chronyd.sock</span><br></pre></td></tr></table></figure>
<p><strong>4）显示所有socket文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-U选项可以显示所有socket文件</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># lsof -U</span></span><br><span class="line">COMMAND    PID    USER   FD   TYPE             DEVICE SIZE/OFF  NODE NAME</span><br><span class="line">systemd      1    root   12u  unix 0xffff9fd375ba5800      0t0 10700 /run/systemd/private</span><br><span class="line">systemd      1    root   14u  unix 0xffff9fd56b38ec00      0t0 42422 socket</span><br><span class="line">systemd      1    root   20u  unix 0xffff9fd577436400      0t0    31 /run/systemd/notify</span><br><span class="line">systemd      1    root   21u  unix 0xffff9fd577436800      0t0    33 /run/systemd/cgroups-agent</span><br><span class="line">systemd      1    root   22u  unix 0xffff9fd375ba1800      0t0 18449 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   23u  unix 0xffff9fd5717e5c00      0t0 19070 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   24u  unix 0xffff9fd3fb00f800      0t0 17293 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   25u  unix 0xffff9fd3fbb68800      0t0 17326 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   26u  unix 0xffff9fd5733cec00      0t0 19182 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   28u  unix 0xffff9fd3fbb7fc00      0t0 19185 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   29u  unix 0xffff9fd574eca400      0t0 24785 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   30u  unix 0xffff9fd574e38000      0t0 24108 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   31u  unix 0xffff9fd376117000      0t0 26054 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   32u  unix 0xffff9fd3fbb74400      0t0 26904 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   33u  unix 0xffff9fd375bec800      0t0 26905 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   34u  unix 0xffff9fd376116c00      0t0 26908 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   35u  unix 0xffff9fd3fb8f5800      0t0 14396 /run/systemd/shutdownd</span><br><span class="line">systemd      1    root   36u  unix 0xffff9fd5733c9000      0t0 22337 socket</span><br><span class="line">systemd      1    root   37u  unix 0xffff9fd375be8800      0t0 22569 /var/run/docker.sock</span><br><span class="line">systemd      1    root   38u  unix 0xffff9fd37612d800      0t0 22571 /run/dbus/system_bus_socket</span><br><span class="line">systemd      1    root   41u  unix 0xffff9fd3fb8f5000      0t0 14401 /run/udev/control</span><br><span class="line">systemd      1    root   42u  unix 0xffff9fd577437800      0t0    41 /run/systemd/journal/stdout</span><br><span class="line">systemd      1    root   43u  unix 0xffff9fd577437c00      0t0    44 /run/systemd/journal/socket</span><br><span class="line">systemd      1    root   45u  unix 0xffff9fd577436000      0t0    46 /dev/<span class="built_in">log</span></span><br><span class="line">systemd-j  462    root    3u  unix 0xffff9fd577437800      0t0    41 /run/systemd/journal/stdout</span><br><span class="line">systemd-j  462    root    4u  unix 0xffff9fd577437c00      0t0    44 /run/systemd/journal/socket</span><br><span class="line">。。。</span><br></pre></td></tr></table></figure>
<h2 id="uptime：显示系统的运行时间及负载"><a href="#uptime：显示系统的运行时间及负载" class="headerlink" title="uptime：显示系统的运行时间及负载"></a>uptime：显示系统的运行时间及负载</h2><p>uptime命令可以输出当前系统时间、系统开机到现在的运行时间、目前有多少用户在线和系统平均负载等信息。</p>
<p><strong>语法格式：uptime</strong></p>
<p><strong>【使用示例】</strong></p>
<p><strong>显示系统的运行时间及负载信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@C7-Server01 ~]<span class="comment"># uptime </span></span><br><span class="line">18:56:22 up  2:59,  1 user,  load average: 0.00, 0.01, 0.05</span><br></pre></td></tr></table></figure>
<h2 id="free：查看系统内存信息"><a href="#free：查看系统内存信息" class="headerlink" title="free：查看系统内存信息"></a>free：查看系统内存信息</h2><p>free命令用于显示系统内存状态，具体包括系统物理内存、虚拟内存、共享内存和系统缓存等。</p>
<p><strong>语法格式：free [option]</strong></p>
<p><strong>重要参数选项</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3b0dcbba119224.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）查看系统内存</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不加任何参数使用free命令，结果是以字节为单位显示，很难看懂</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># free</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:        7992344      243632      259960       12084     7488752     7369040</span><br><span class="line">Swap:       8388604           0     8388604</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-m选项以MB为单位显示，但是可能不是很精确</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># free -m</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7805         238         253          11        7313        7196</span><br><span class="line">Swap:          8191           0        8191</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-h选项，以人类可读的方式显示</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># free -h</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7.6G        238M        253M         11M        7.1G        7.0G</span><br><span class="line">Swap:          8.0G          0B        8.0G</span><br></pre></td></tr></table></figure>
<p><strong>Linux系统的特性是将不用的物理内存缓存起来，因此253MB不是系统的真实剩余内存，系统真正可用的内存为7.0G。buffers为写入数据的缓冲区，cache为读取数据的缓冲区。</strong></p>
<p><strong>2）定时查询内存</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-s选项设定每10秒刷新一次内存</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># free -h -s 10</span></span><br><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7.6G        236M        7.1G         11M        327M        7.1G</span><br><span class="line">Swap:          8.0G          0B        8.0G</span><br><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7.6G        236M        7.1G         11M        327M        7.1G</span><br><span class="line">Swap:          8.0G          0B        8.0G</span><br><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7.6G        237M        7.1G         11M        327M        7.1G</span><br><span class="line">Swap:          8.0G          0B        8.0G</span><br><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7.6G        237M        7.1G         11M        327M        7.1G</span><br><span class="line">Swap:          8.0G          0B        8.0G</span><br></pre></td></tr></table></figure>
<h2 id="iftop：动态显示网络接口流量信息"><a href="#iftop：动态显示网络接口流量信息" class="headerlink" title="iftop：动态显示网络接口流量信息"></a>iftop：动态显示网络接口流量信息</h2><p>iftop是一款实时流量监控工具，可用于监控TCP/IP连接等，必须以root用户的身份运行。一般最小化安装系统都是没有这个命令的，需要使用yum命令额外安装，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装iftop</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># yum list | grep iftop</span></span><br><span class="line">iftop.x86_64                            1.0-0.14.pre4.el7              epel    </span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># yum install -y iftop</span></span><br></pre></td></tr></table></figure>
<p><strong>语法格式：iftop [option]</strong></p>
<p><strong>重要参数选项</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3b7b2821539240.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）不使用任何选项启动iftop命令监控流量</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认监听系统的第一块网卡，可以使用-i选项指定网卡</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iftop</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2019/05/27/5ceb3ba4db46537601.jpg"></p>
<blockquote>
<p><strong>上图说明如下：</strong></p>
<p>界面上显示的是类似刻度尺的刻度范围，是以标尺的形式显示流量图形的长条。</p>
<p>中间的&lt;=或=&gt;这两个左右箭头，表示的是流量的方向。</p>
<p>TX：发送流量。</p>
<p>RX：接收流量。</p>
<p>TOTAL：总流量。</p>
<p>Cum：运行iftop到目前时间的总流量。</p>
<p>peak：流量峰值。</p>
<p>rates：分别表示过去2s、10s、40s的平均流量。</p>
</blockquote>
<p><strong>2）常用命令组合</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -nNBP用于显示各服务端口号的流量情况，单位为byte</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认显示第一块网卡的流量，可以通过-i选项指定网卡</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iftop -nNBP</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2019/05/27/5ceb3bdb6a02c59773.jpg"></p>
<h2 id="vmstat：虚拟内存统计"><a href="#vmstat：虚拟内存统计" class="headerlink" title="vmstat：虚拟内存统计"></a>vmstat：虚拟内存统计</h2><p>vmstat是Virtual Memory Statistics（虚拟内存统计）的缩写，利用vmstat命令可以对操作系统的内存信息、进程状态和CPU活动等进行监视。但是只能对系统的整体情况进行统计，无法对某个进程进行深入分析。</p>
<p><strong>语法格式：vmstat [option] [delay [ count]]，delay表示两次输出之间的间隔时间。count表示按照delay指定的时间间隔统计的次数。</strong></p>
<p><strong>重要参数选项</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3bfc5d87271319.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）显示虚拟内存的使用情况</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果省略间隔时间和次数选项，则仅显示最后一次报告就退出</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat </span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line"> 1  0      0 7267600   2076 479564    0    0    79     4   55   57  0  0 100  0  0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用delay选项，可以每隔n秒显示一次，直到ctrl+c退出</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat 5</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line"> 1  0      0 7267436   2076 479652    0    0    75     4   53   56  0  0 100  0  0</span><br><span class="line"> 1  0      0 7267412   2076 479652    0    0     0     0   95  104  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   84  101  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   87  106  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   88   99  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   91  102  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   83  100  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   90  105  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   85   95  0  0 100  0  0</span><br><span class="line">^C </span><br><span class="line"></span><br><span class="line"><span class="comment"># 加上count选项，可以按照指定次数显示，完成后自动退出</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat 5 6</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line"> 1  0      0 7267312   2076 479652    0    0    70     3   51   54  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0  102  110  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   85   95  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   85   97  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   90   98  0  0 100  0  0</span><br><span class="line"> 0  0      0 7267288   2076 479652    0    0     0     0   89   97  0  0 100  0  0</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>上面输出的结果说明：</strong></p>
<p>第1列：procs。</p>
<p>​    r列表示运行和等待CPU时间片的进程数。</p>
<p>​    b列表示正在等待资源的进程数。</p>
<p>第2列：memory。</p>
<p>​    swpd列表示使用虚拟内存的大小。</p>
<p>​    free列表示当前空闲的物理内存数量。</p>
<p>​    buff列表示buffers的内存数量。</p>
<p>​    cache列表示cache的内存数量。</p>
<p>第3列：swap。</p>
<p>​    si（swap in）列表示由磁盘调入内存，也就是磁盘读入内存交换区的数量。</p>
<p>​    so（swap out）列表示由内存调入磁盘，也就是内存交换区写入磁盘的数量。</p>
<p>第4列：I/O项显示磁盘读写状况。</p>
<p>​    bi列表示从块设备读入数据的总量（即读磁盘）（块/s）。</p>
<p>​    bo列表示写入块设备的数据总量（即写磁盘）（块/s）。</p>
<p>第5列：system显示采集间隔内发生的中断数。</p>
<p>​    in列表示在某一时间间隔中观测到的每秒设备中断数。</p>
<p>​    cs列表示每秒产生的上下文切换次数。</p>
<p>第6列：CPU项显示了CPU的使用状态。</p>
<p>​    us列显示了用户进程消耗的CPU时间百分比。</p>
<p>​    sy列显示了系统（内核）进程消耗的CPU时间百分比。</p>
<p>​    id列显示了CPU处在空闲状态的时间百分比。</p>
<p>​    wa列显示了I/O等待所占用的CPU时间百分比。</p>
<p>​    st列显示了虚拟机占用的CPU时间的百分比。</p>
</blockquote>
<p><strong>2）显示活跃和非活跃内存</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每2秒刷新一次，共刷新5此，通过-a选项显示系统活跃和非活跃内存</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat -a 2 5</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line">r  b   swpd   free  inact active   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line">1  0      0 7266764 244696 250212    0    0    57     3   45   48  0  0 100  0  0</span><br><span class="line">0  0      0 7266648 244696 250168    0    0     0     0   98  104  0  0 100  0  0</span><br><span class="line">0  0      0 7266648 244696 250168    0    0     0     0   81   93  0  0 100  0  0</span><br><span class="line">0  0      0 7266648 244696 250168    0    0     0     0   82   93  0  0 100  0  0</span><br><span class="line">0  0      0 7266648 244696 250168    0    0     0     0  114  135  0  0 100  0  0</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>inact：表示非活跃内存的大小。</strong></li>
<li><strong>active：表示活跃内存的大小。</strong></li>
</ul>
<p><strong>3）查看内存使用的详细信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过-s选项可以查看内存使用的详细信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些信息来自/proc/meminfo、/proc/stat和/proc/vmstat等内存映射文件</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat -s </span></span><br><span class="line">7992344 K total memory</span><br><span class="line">243984 K used memory</span><br><span class="line">250216 K active memory</span><br><span class="line">244696 K inactive memory</span><br><span class="line">7266392 K free memory</span><br><span class="line">2076 K buffer memory</span><br><span class="line">479892 K swap cache</span><br><span class="line">8388604 K total swap</span><br><span class="line">0 K used swap</span><br><span class="line">8388604 K free swap</span><br><span class="line">390 non-nice user cpu ticks</span><br><span class="line">0 nice user cpu ticks</span><br><span class="line">1466 system cpu ticks</span><br><span class="line">812275 idle cpu ticks</span><br><span class="line">229 IO-wait cpu ticks</span><br><span class="line">0 IRQ cpu ticks</span><br><span class="line">52 softirq cpu ticks</span><br><span class="line">0 stolen cpu ticks</span><br><span class="line">411934 pages paged <span class="keyword">in</span></span><br><span class="line">20492 pages paged out</span><br><span class="line">0 pages swapped <span class="keyword">in</span></span><br><span class="line">0 pages swapped out</span><br><span class="line">348908 interrupts</span><br><span class="line">371812 CPU context switches</span><br><span class="line">1556980554 boot time</span><br><span class="line">2038 forks</span><br></pre></td></tr></table></figure>
<p><strong>4）查看磁盘的读写信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-d可以查看所有磁盘的读写信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这些信息主要来自/proc/diskstats文件，merged表示合并写/读请求次数</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat -d</span></span><br><span class="line">disk- ------------reads------------ ------------writes----------- -----IO------</span><br><span class="line">total merged sectors      ms  total merged sectors      ms    cur    sec</span><br><span class="line">sr0       18      0    2056      28      0      0       0       0      0      0</span><br><span class="line">sda    10037      2  821813    7396   2986    132   40987    1497      0      4</span><br></pre></td></tr></table></figure>
<p><strong>5）查看指定分区的读写信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过-p选项可以指定分区查看读写信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># vmstat -p /dev/sda3</span></span><br><span class="line">sda3          reads   <span class="built_in">read</span> sectors  writes    requested writes</span><br><span class="line">8008     771194        931      36850</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>这些信息主要来自于/proc/diskstats，输出结果各列的说明具体如下：</strong></p>
<p>reads：来自于该分区的读的次数。</p>
<p>read sectors：来自于该分区的读扇区的次数。</p>
<p>writes：来自于该分区的写的次数。</p>
<p>requested writes：来自于该分区的写请求次数。</p>
</blockquote>
<h2 id="mpstat：CPU信息统计"><a href="#mpstat：CPU信息统计" class="headerlink" title="mpstat：CPU信息统计"></a>mpstat：CPU信息统计</h2><p>mpstat是Multiprocessor Statistics的缩写，是一种实时系统监控工具。mpstat命令会输出CPU的一些统计信息，这些信息存放在/proc/stat文件中。在多CPU的系统里，此命令不但能用来查看所有CPU的平均状况信息，而且还能够用来查看特定CPU的信息。mpstat命令的最大特点是：可以查看多核心CPU中每个计算核心的统计数据，而类似命令vmstat只能查看系统整体的CPU情况。</p>
<p><strong>语法格式：mpstat [option] [delay [ count]]，delay和count的含义同vmstat。</strong></p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3ccb675ce10702.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）显示CPU信息统计</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不加任何选项，默认显示所有CPU信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 省却delay和count，仅显示最后一次报告就退出</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># mpstat </span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line"></span><br><span class="line">11:26:00 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle</span><br><span class="line">11:26:00 PM  all    0.05    0.00    0.15    0.02    0.00    0.00    0.00    0.00    0.00   99.77</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每2秒刷新一次，共刷新5次</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># mpstat 2 5</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line"></span><br><span class="line">11:27:09 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle</span><br><span class="line">11:27:11 PM  all    0.00    0.00    0.12    0.00    0.00    0.00    0.00    0.00    0.00   99.88</span><br><span class="line">11:27:13 PM  all    0.00    0.00    0.12    0.00    0.00    0.00    0.00    0.00    0.00   99.88</span><br><span class="line">11:27:15 PM  all    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00</span><br><span class="line">11:27:17 PM  all    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00</span><br><span class="line">11:27:19 PM  all    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00</span><br><span class="line">Average:     all    0.00    0.00    0.05    0.00    0.00    0.00    0.00    0.00    0.00   99.95</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果的说明如下：</strong></p>
<p>第1列：11：27：09 PM，表示当前时间。</p>
<p>第2列：CPU，all表示所有CPU，0表示第一个CPU……</p>
<p>后面9列的含义分别如下。</p>
<p>％usr：用户进程消耗的CPU时间百分比。</p>
<p>％nice：改变过优先级的进程占用的CPU时间百分比。</p>
<p>％sys：系统（内核）进程消耗的CPU时间百分比。</p>
<p>％iowait：IO等待所占用的CPU时间百分比。</p>
<p>％irq：硬中断占用的CPU时间百分比。</p>
<p>％soft：软中断占用的CPU时间百分比。</p>
<p>％steal：虚拟机强制CPU等待的时间百分比。</p>
<p>％guest：虚拟机占用CPU时间的百分比。</p>
<p>％idle：CPU处在空闲状态的时间百分比。</p>
</blockquote>
<p><strong>2）显示指定CPU的信息统计</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 系统有4个cpu，通过-P选项指定显示第二个CPU的信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># mpstat -P 1</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">11:30:31 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle</span><br><span class="line">11:30:31 PM    1    0.06    0.00    0.22    0.02    0.00    0.01    0.00    0.00    0.00   99.70</span><br></pre></td></tr></table></figure>
<p>注意：这里的CPU指的是逻辑CPU，也就是超线程。</p>
<h2 id="iostat：I-O信息统计"><a href="#iostat：I-O信息统计" class="headerlink" title="iostat：I/O信息统计"></a>iostat：I/O信息统计</h2><p>iostat是I/O statistics（输入/输出统计）的缩写，其主要功能是对系统的磁盘I/O操作进行监视。它的输出主要是显示磁盘读写操作的统计信息，同时也会给出CPU的使用情况。同vmstat命令一样，iostat命令也不能对某个进程进行深入分析，仅会对系统的整体情况进行分析。</p>
<p><strong>语法格式：iostat [option] [ interval [ count ] ]，interval同delay。</strong></p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3d27f0cb984707.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）显示所有设备的负载情况</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认不接任何选项，显示所有设备的负载情况</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 省略时间间隔和次数，仅显示最后一次报告就退出</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iostat </span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">0.05    0.00    0.13    0.02    0.00   99.80</span><br><span class="line">Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">scd0              0.01         0.29         0.00       1028          0</span><br><span class="line">sda               3.86       115.53         8.72     411970      31087</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果的说明如下：</strong></p>
<p>第1～2行中各列的含义具体如下：</p>
<p>％user：用户进程消耗的CPU时间百分比。</p>
<p>％nice：改变过优先级的进程占用的CPU时间百分比。</p>
<p>％system：系统（内核）进程消耗的CPU时间百分比。</p>
<p>％iowait：IO等待所占用的CPU时间百分比。</p>
<p>％steal：虚拟机强制CPU等待的时间百分比。</p>
<p>％idle：CPU处在空闲状态的时间百分比。</p>
<p>第3～4行中各列的含义如下：</p>
<p>tps：表示该设备每秒的传输次数，“一次传输”的意思是“一次I/O请求”，多个逻辑请求可能会被合并为“一次I/O请求”，“一次传输”请求的大小是未知的。</p>
<p>kB_read/s：表示每秒读取的数据块数。</p>
<p>kB_wrtn/s：表示每秒写入的数据块数。</p>
<p>kB_read：表示读取的所有块数。</p>
<p>kB_wrtn：表示写入的所有块数。</p>
</blockquote>
<p><strong>3）只显示磁盘统计信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过-d选项直线磁盘的统计信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iostat -d</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">scd0              0.00         0.27         0.00       1028          0</span><br><span class="line">sda               3.63       108.57         8.20     411970      31124</span><br></pre></td></tr></table></figure>
<p><strong>4）查看扩展信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-x选项可以查看扩展信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iostat -d -x</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util</span><br><span class="line">scd0              0.00     0.00    0.00    0.00     0.27     0.00   114.22     0.00    1.56    1.56    0.00   1.11   0.00</span><br><span class="line">sda               0.00     0.05    2.63    0.93   106.63     8.06    64.38     0.00    0.68    0.74    0.54   0.33   0.12</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果说明如下：</strong></p>
<p>rrqm/s：每秒进行merge的读操作数目。</p>
<p>wrqm/s：每秒进行merge的写操作数目。</p>
<p>r/s：每秒完成的读I/O设备次数。</p>
<p>w/s：每秒完成的写I/O设备次数。</p>
<p>rkB/s：每秒读入的千字节数。</p>
<p>wkB/s：每秒写入的千字节数。</p>
<p>avgrq-sz：设备平均每次进行I/O操作的数据大小（扇区）。</p>
<p>avgqu-sz：平均I/O队列长度。</p>
<p>await：设备平均每次I/O操作的等待时间（毫秒）。</p>
<p>svctm：设备平均每次I/O操作的服务时间（毫秒）。</p>
<p>％util：每秒钟用于I/O操作的百分比。</p>
</blockquote>
<p><strong>5）只查看CPU的统计信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过-c选项可以产看CPU的统计信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iostat -c</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">0.04    0.00    0.12    0.02    0.00   99.82</span><br></pre></td></tr></table></figure>
<h2 id="iotop：动态显示磁盘I-O统计信息"><a href="#iotop：动态显示磁盘I-O统计信息" class="headerlink" title="iotop：动态显示磁盘I/O统计信息"></a>iotop：动态显示磁盘I/O统计信息</h2><p>iotop命令是一款实时监控磁盘I/O的工具，但必须以root用户的身份运行。使用iotop命令可以很方便地查看每个进程使用磁盘I/O的情况。最小化安装系统一般是没有这个命令的，需要使用yum命令额外安装，安装命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install iotop</span><br></pre></td></tr></table></figure>
<p><strong>语法格式：iotop [option]</strong></p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3dd50f76288111.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>不使用任何参数</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过iotop指令启动服务，类似top指令，不过它只显示磁盘io的使用情况</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># iotop</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2019/05/27/5ceb3dfba05f727072.jpg"></p>
<blockquote>
<p><strong>命令显示结果的说明如下：</strong></p>
<p>Total DISK READ：总的磁盘读取速度。</p>
<p>Total DISK WRITE：总的磁盘写入速度。</p>
<p>TID：进程pid值。</p>
<p>PRIO：优先级。</p>
<p>USER：用户。</p>
<p>DISK READ：磁盘读取速度。</p>
<p>DISK WRITE：磁盘写入速度。</p>
<p>SWAPIN：从swap分区读取数据占用的百分比。</p>
<p>IO：I/O占用的百分比。</p>
<p>COMMAND：消耗I/O的进程名。</p>
</blockquote>
<h2 id="sar：收集系统信息"><a href="#sar：收集系统信息" class="headerlink" title="sar：收集系统信息"></a>sar：收集系统信息</h2><p>通过sar命令，可以全面地获取系统的CPU、运行队列、磁盘I/O、分页（交换区）、内存、CPU中断和网络等性能数据。</p>
<p><strong>语法格式：sar [option] [ interval [ count ] ]</strong></p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3e2aa200578443.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）查看系统CPU的负载</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-u选项只显示系统CPU的负载情况</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -u 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">11:55:12 PM     CPU     %user     %nice   %system   %iowait    %steal     %idle</span><br><span class="line">11:55:14 PM     all      0.00      0.00      0.00      0.00      0.00    100.00</span><br><span class="line">11:55:16 PM     all      0.00      0.00      0.12      0.00      0.00     99.88</span><br><span class="line">11:55:18 PM     all      0.00      0.00      0.00      0.00      0.00    100.00</span><br><span class="line">Average:        all      0.00      0.00      0.04      0.00      0.00     99.96</span><br></pre></td></tr></table></figure>
<p><strong>2）显示运行队列的大小</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-q选项，只显示运行队列大小</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -q 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">11:56:26 PM   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15   blocked</span><br><span class="line">11:56:28 PM         0       248      0.00      0.01      0.05         0</span><br><span class="line">11:56:30 PM         0       248      0.00      0.01      0.05         0</span><br><span class="line">11:56:32 PM         1       248      0.00      0.01      0.05         0</span><br><span class="line">Average:            0       248      0.00      0.01      0.05         0</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果说明如下：</strong></p>
<p>runq-sz：运行队列的长度（等待运行的进程数）。</p>
<p>plist-sz：进程列表中进程（process）和线程（thread）的数量。</p>
<p>ldavg-1：最后1分钟的系统平均负载（system load average）。</p>
<p>ldavg-5：过去5分钟的系统平均负载。</p>
<p>ldavg-15：过去15分钟的系统平均负载。</p>
</blockquote>
<p><strong>3）只显示系统内存的使用情况</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-r选项，只显示系统内存的使用</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -r 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/04/2019 	_x86_64_	(4 CPU)</span><br><span class="line">11:59:34 PM kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty</span><br><span class="line">11:59:36 PM   7258452    733892      9.18      2076    390608    558672      3.41    268816    230800         0</span><br><span class="line">11:59:38 PM   7258452    733892      9.18      2076    390608    558672      3.41    268816    230800         0</span><br><span class="line">11:59:40 PM   7258452    733892      9.18      2076    390608    558672      3.41    268824    230800         0</span><br><span class="line">Average:      7258452    733892      9.18      2076    390608    558672      3.41    268819    230800         0</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果说明如下：</strong></p>
<p>kbmemfree：空闲物理内存量。</p>
<p>kbmemused：使用中的物理内存量。</p>
<p>％memused：物理内存量的使用率。</p>
<p>kbbuffers：内核中作为缓冲区使用的物理内存容量。</p>
<p>kbcached：内核中作为缓存使用的物理内存容量。</p>
<p>kbcommit：应用程序当前使用的内存大小。</p>
<p>％commit：应用程序当前使用的内存大小占总大小的使用百分比。</p>
</blockquote>
<p><strong>4）显示缓冲区的使用情况</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-b选项，只显示缓冲区的使用情况</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -b 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/05/2019 	_x86_64_	(4 CPU)</span><br><span class="line">12:01:59 AM       tps      rtps      wtps   bread/s   bwrtn/s</span><br><span class="line">12:02:01 AM      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:02:03 AM      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:02:05 AM      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:         0.00      0.00      0.00      0.00      0.00</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果如下：</strong></p>
<p>tps：每秒钟物理设备的I/O传输总量。</p>
<p>rtps：每秒钟从物理设备读入的数据总量。</p>
<p>wtps：每秒钟向物理设备写入的数据总量。</p>
<p>bread/s：每秒钟从物理设备读入的数据量，单位为块/s。</p>
<p>bwrtn/s：每秒钟向物理设备写入的数据量，单位为块/s。</p>
</blockquote>
<p><strong>5）显示网络的运行状态</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-n选项，只显示网络运行状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DEV表示网络接口</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -n DEV 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/05/2019 	_x86_64_	(4 CPU)</span><br><span class="line"></span><br><span class="line">12:04:55 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s</span><br><span class="line">12:04:57 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:57 AM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:57 AM      eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:57 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:57 AM vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:57 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">12:04:57 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s</span><br><span class="line">12:04:59 AM      eth0      0.50      0.50      0.03      0.37      0.00      0.00      0.00</span><br><span class="line">12:04:59 AM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:59 AM      eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:59 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:59 AM vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:04:59 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">12:04:59 AM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s</span><br><span class="line">12:05:01 AM      eth0      0.50      0.50      0.03      0.37      0.00      0.00      0.00</span><br><span class="line">12:05:01 AM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:05:01 AM      eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:05:01 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:05:01 AM vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:05:01 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">Average:        IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s</span><br><span class="line">Average:         eth0      0.33      0.33      0.02      0.25      0.00      0.00      0.00</span><br><span class="line">Average:         eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:         eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:           lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:    vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:      docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示网络接口错包统计</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># EDEV表示网络接口错误信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -n EDEV 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/05/2019 	_x86_64_	(4 CPU)</span><br><span class="line"></span><br><span class="line">12:06:49 AM     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s</span><br><span class="line">12:06:51 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:51 AM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:51 AM      eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:51 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:51 AM vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:51 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">12:06:51 AM     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s</span><br><span class="line">12:06:53 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:53 AM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:53 AM      eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:53 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:53 AM vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:53 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">12:06:53 AM     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s</span><br><span class="line">12:06:55 AM      eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:55 AM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:55 AM      eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:55 AM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:55 AM vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:06:55 AM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line">Average:        IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s</span><br><span class="line">Average:         eth0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:         eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:         eth2      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:           lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:    vethc27967f      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:      docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过SOCK关键字，可以只显示套接字信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -n SOCK 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/05/2019 	_x86_64_	(4 CPU)</span><br><span class="line"></span><br><span class="line">12:08:42 AM    totsck    tcpsck    udpsck    rawsck   ip-frag    tcp-tw</span><br><span class="line">12:08:44 AM       979         4         1         0         0         0</span><br><span class="line">12:08:46 AM       979         4         1         0         0         0</span><br><span class="line">12:08:48 AM       979         4         1         0         0         0</span><br><span class="line">Average:          979         4         1         0         0         0</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>命令输出结果的说明：</strong></p>
<p>IFACE：网络接口。</p>
<p>rxpck/s：每秒钟接收的数据包。</p>
<p>txpck/s：每秒钟发送的数据包。</p>
<p>rxkB/s：每秒钟接收的字节数。</p>
<p>txkB/s：每秒钟发送的字节数。</p>
<p>rxcmp/s：每秒钟接收的压缩数据包。</p>
<p>txcmp/s：每秒钟发送的压缩数据包。</p>
<p>rxmcst/s：每秒钟接收的多播数据包。</p>
</blockquote>
<p><strong>6）显示磁盘的读写性能</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过-d选项，可以只显示磁盘的读写状态</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># sar -d 2 3</span></span><br><span class="line">Linux 3.10.0-862.el7.x86_64 (C7-Server01) 	05/05/2019 	_x86_64_	(4 CPU)</span><br><span class="line">12:10:13 AM       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">12:10:15 AM   dev11-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:10:15 AM    dev8-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:10:15 AM       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">12:10:17 AM   dev11-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:10:17 AM    dev8-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:10:17 AM       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">12:10:19 AM   dev11-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">12:10:19 AM    dev8-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:          DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util</span><br><span class="line">Average:      dev11-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br><span class="line">Average:       dev8-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>输出结果说明如下：</strong></p>
<p>DEV：表示磁盘的设备名称。</p>
<p>tps：表示该设备每秒的传输次数，“一次传输”的意思是“一次I/O请求”，多个逻辑请求可能会被合并为“一次I/O请求”，“一次传输”请求的大小是未知的。</p>
<p>rd_sec/s：表示每秒从设备读取的扇区数。</p>
<p>wr_sec/s：表示每秒写入设备的扇区数目。</p>
<p>avgrq-sz：设备平均每次I/O操作的数据大小（扇区）。</p>
<p>avgqu-sz：平均I/O队列长度。</p>
<p>await：设备平均每次I/O操作的等待时间（毫秒）。</p>
<p>svctm：设备平均每次I/O操作的服务时间（毫秒）。</p>
<p>％util：每秒钟用于I/O操作的百分比。</p>
</blockquote>
<h2 id="ntsysv：管理开机服务"><a href="#ntsysv：管理开机服务" class="headerlink" title="ntsysv：管理开机服务"></a>ntsysv：管理开机服务</h2><p>ntsysv命令提供了一种基于文本界面的菜单操作方式，以设置不同运行级别下的系统服务启动状态。</p>
<p>此工具在最小化系统安装时没有安装，需要手动安装，安装命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询ntsysv的yum包，结果显示属于基础包</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># yum list | grep ntsysv</span></span><br><span class="line">ntsysv.x86_64                           1.7.4-1.el7                    base</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行yum install进行安装</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># yum install -y ntsysv</span></span><br></pre></td></tr></table></figure>
<p><strong>语法格式：ntsysv [option]</strong> </p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3f2f7bcc312594.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>配置系统服务</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在命令行直接输入ntsysv，进入交互式菜单界面</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># ntsysv</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2019/05/27/5ceb3f56f2f2286102.jpg"></p>
<p><strong>进入后，就可以通过键盘的上下左右键和tab键选择你需要配置的开机启动服务，如果需要确认某个选项，按空格键完成，取消确认按两次空格键即可。</strong></p>
<h2 id="rpm：RPM包管理器"><a href="#rpm：RPM包管理器" class="headerlink" title="rpm：RPM包管理器"></a>rpm：RPM包管理器</h2><p>rpm命令的全称是Red Hat Package Manager（Red Hat包管理器），几乎所有的Linux发行版本都使用了这种形式的命令管理、安装、更新和卸载软件。概括地说，rpm命令包含了五种基本功能（不包括创建rpm包）：安装、卸载、升级、查询和验证。</p>
<p><strong>语法格式：rpm [option]</strong></p>
<p><strong>重要选项参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb3f77ab40292709.jpg"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载一个软件包作为测试</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># wget https://mirrors.aliyun.com/centos/6/os/x86_64/Packages/lrzsz-0.12.20-27.1.el6.x86_64.rpm</span></span><br><span class="line">--2019-05-05 00:35:39--  https://mirrors.aliyun.com/centos/6/os/x86_64/Packages/lrzsz-0.12.20-27.1.el6.x86_64.rpm</span><br><span class="line">Resolving mirrors.aliyun.com (mirrors.aliyun.com)... 112.19.3.240, 112.19.3.241, 112.19.3.182, ...</span><br><span class="line">Connecting to mirrors.aliyun.com (mirrors.aliyun.com)|112.19.3.240|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 72436 (71K) [application/x-redhat-package-manager]</span><br><span class="line">Saving to: ‘lrzsz-0.12.20-27.1.el6.x86_64.rpm’</span><br><span class="line">100%[=====================================================&gt;] 72,436      --.-K/s   <span class="keyword">in</span> 0.07s   </span><br><span class="line">2019-05-05 00:35:42 (974 KB/s) - ‘lrzsz-0.12.20-27.1.el6.x86_64.rpm’ saved [72436/72436]</span><br></pre></td></tr></table></figure>
<p><strong>【使用示例】</strong></p>
<p><strong>1）查看rpm包信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示rpm包概要信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-q选项查询软件包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-p选项指定某一个rpm包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-i选线关于-qp联用，表示查看某个rpm包的概要信息</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -qpi lrzsz-0.12.20-27.1.el6.x86_64.rpm </span></span><br><span class="line">warning: lrzsz-0.12.20-27.1.el6.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID c105b9de: NOKEY</span><br><span class="line">Name        : lrzsz</span><br><span class="line">Version     : 0.12.20</span><br><span class="line">Release     : 27.1.el6</span><br><span class="line">Architecture: x86_64</span><br><span class="line">Install Date: (not installed)</span><br><span class="line">Group       : Applications/Communications</span><br><span class="line">Size        : 162901</span><br><span class="line">License     : GPLv2+</span><br><span class="line">Signature   : RSA/SHA256, Sun 03 Jul 2011 12:43:30 PM CST, Key ID 0946fca2c105b9de</span><br><span class="line">Source RPM  : lrzsz-0.12.20-27.1.el6.src.rpm</span><br><span class="line">Build Date  : Thu 19 Aug 2010 02:20:40 PM CST</span><br><span class="line">Build Host  : c6b3.bsys.dev.centos.org</span><br><span class="line">Relocations : (not relocatable)</span><br><span class="line">Packager    : CentOS BuildSystem </span><br><span class="line">Vendor      : CentOS</span><br><span class="line">URL         : http://www.ohse.de/uwe/software/lrzsz.html</span><br><span class="line">Summary     : The lrz and lsz modem communications programs</span><br><span class="line">Description :</span><br><span class="line">Lrzsz (consisting of lrz and lsz) is a cosmetically modified</span><br><span class="line">zmodem/ymodem/xmodem package built from the public-domain version of</span><br><span class="line">the rzsz package. Lrzsz was created to provide a working GNU</span><br><span class="line">copylefted Zmodem solution <span class="keyword">for</span> Linux systems.</span><br></pre></td></tr></table></figure>
<p><strong>2）查询软件包内容</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-q选项表示查询软件包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-p选项表示查询某一个rpm包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-l选项表示查看某一个rpm包里的软件列表</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -qpl lrzsz-0.12.20-27.1.el6.x86_64.rpm </span></span><br><span class="line">warning: lrzsz-0.12.20-27.1.el6.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID c105b9de: NOKEY</span><br><span class="line">/usr/bin/rb</span><br><span class="line">/usr/bin/rx</span><br><span class="line">/usr/bin/rz</span><br><span class="line">/usr/bin/sb</span><br><span class="line">/usr/bin/sx</span><br><span class="line">/usr/bin/sz</span><br><span class="line">/usr/share/locale/de/LC_MESSAGES/lrzsz.mo</span><br><span class="line">/usr/share/man/man1/rz.1.gz</span><br><span class="line">/usr/share/man/man1/sz.1.gz</span><br></pre></td></tr></table></figure>
<p><strong>3）查询软件包的依赖</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-q选项表示查询软件包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-p选项表示查询某一个rpm包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-R选项表示查看某一个rpm包依赖关系</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -qpR lrzsz-0.12.20-27.1.el6.x86_64.rpm </span></span><br><span class="line">warning: lrzsz-0.12.20-27.1.el6.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID c105b9de: NOKEY</span><br><span class="line">libc.so.6()(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.11)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.2.5)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.3)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.3.4)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.4)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.7)(64bit)</span><br><span class="line">libnsl.so.1()(64bit)</span><br><span class="line">rpmlib(CompressedFileNames) &lt;= 3.0.4-1</span><br><span class="line">rpmlib(FileDigests) &lt;= 4.6.0-1</span><br><span class="line">rpmlib(PartialHardlinkSets) &lt;= 4.0.4-1</span><br><span class="line">rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1</span><br><span class="line">rtld(GNU_HASH)</span><br><span class="line">rpmlib(PayloadIsXz) &lt;= 5.2-1</span><br></pre></td></tr></table></figure>
<p><strong>4）安装软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单独使用-i选项，表示安装某一个rpm包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-v选项，表示安装时显示详细信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-h选项，表示用‘#’符号显示安装进度条</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -ivh lrzsz-0.12.20-27.1.el6.x86_64.rpm </span></span><br><span class="line">warning: lrzsz-0.12.20-27.1.el6.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID c105b9de: NOKEY</span><br><span class="line">Preparing...                          <span class="comment">################################# [100%]</span></span><br><span class="line">	package lrzsz-0.12.20-36.el7.x86_64 (<span class="built_in">which</span> is newer than lrzsz-0.12.20-27.1.el6.x86_64) is already installed</span><br><span class="line">	file /usr/bin/rb from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br><span class="line">	file /usr/bin/rx from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br><span class="line">	file /usr/bin/rz from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br><span class="line">	file /usr/bin/sb from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br><span class="line">	file /usr/bin/sx from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br><span class="line">	file /usr/bin/sz from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br><span class="line">	file /usr/share/man/man1/sz.1.gz from install of lrzsz-0.12.20-27.1.el6.x86_64 conflicts with file from package lrzsz-0.12.20-36.el7.x86_64</span><br></pre></td></tr></table></figure>
<p><strong>注意：我的机器因为已经安装过lrzsz工具，所以有上面的提示。</strong></p>
<p><strong>5）查询系统是否已经安装某个软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-q选项，表示查询软件包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-a选项，表示查询系统是否已经安装某个软件包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果没有输出，表示没有安装，如果有输出表示已经安装</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -qa lrzsz</span></span><br><span class="line">lrzsz-0.12.20-36.el7.x86_64</span><br></pre></td></tr></table></figure>
<p><strong>6）卸载软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-e选项，可以卸载指定的rpm包</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -e lrzsz</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：这个参数比较危险，因为通过rpm是强依赖卸载，因为很有可能会误删除一些系统必备的文件，最后导致系统损坏。如果非要卸载，可以通过yum工具完成。</strong></p>
<p><strong>7）插叙文件属于哪个软件包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-q选项，表示查询软件包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用-f选项，表示查询文件属于哪个软件包</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># rpm -qf $(which ifconfig)</span></span><br><span class="line">net-tools-2.0-0.24.20131004git.el7.x86_64</span><br></pre></td></tr></table></figure>
<p><strong>有时候会发现系统没有某些文件或者命令，但是又不知道这个文件或命令是属于哪个软件包，这时就可以使用-f参数来查询（在有这个文件的系统上查询）。比如本例查询ifconfig命令属于net-tools软件包。</strong></p>
<h2 id="yum：自动化RPM包管理工具"><a href="#yum：自动化RPM包管理工具" class="headerlink" title="yum：自动化RPM包管理工具"></a>yum：自动化RPM包管理工具</h2><p>yum（Yellow dog Updater Modified）是多个Linux发行版的软件包管理器，例如Redhat RHEL、CentOS和Fedora。yum主要用于自动安装、升级rpm软件包，它能自自动查找并解决rpm包之间的依赖关系。如下图：</p>
<p><img src="https://i.loli.net/2019/05/27/5ceb4053ebcb844502.jpg"></p>
<p>通过执行yum install -y lrzsz命令后，它会自动发现系统老版本的软件包，然后进行更新，更新后会自动删除老版本的软件包。</p>
<p><strong>语法格式：yum [option] [command] [package]</strong></p>
<p><strong>重要选线参数</strong></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb406c42a6f39618.jpg"></p>
<p><img src="https://i.loli.net/2019/05/27/5ceb408073af029814.jpg"></p>
<p><strong>【使用示例】</strong></p>
<p><strong>1）安装httpd软件包</strong></p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用-y选项，自动确认，无需交互式手动</span></span><br><span class="line">    </span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># yum install -y httpd</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">    </span><br><span class="line">- base: mirrors.aliyun.com</span><br><span class="line">- epel: mirrors.njupt.edu.cn</span><br><span class="line">- extras: mirrors.huaweicloud.com</span><br><span class="line">- updates: mirrors.huaweicloud.com</span><br><span class="line">Package httpd-2.4.6-89.el7.centos.x86_64 already installed and latest version</span><br><span class="line">Nothing to <span class="keyword">do</span></span><br></pre></td></tr></table></figure>
<p>​    </p>
<p><strong>2）查看已安装和未安装的包组</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用grouplist命令，可以查看所有包组情况</span></span><br><span class="line"></span><br><span class="line">[root@C7-Server01 ~]<span class="comment"># yum grouplist</span></span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">      There is no installed groups file.</span><br><span class="line">      Maybe run: yum groups mark convert (see man yum)</span><br><span class="line">      Loading mirror speeds from cached hostfile</span><br><span class="line">    - base: mirrors.aliyun.com</span><br><span class="line">    - epel: mirrors.njupt.edu.cn</span><br><span class="line">    - extras: mirrors.huaweicloud.com</span><br><span class="line">    - updates: mirrors.huaweicloud.com</span><br><span class="line">      Available Environment Groups:</span><br><span class="line">      Minimal Install</span><br><span class="line">      Compute Node</span><br><span class="line">      Infrastructure Server</span><br><span class="line">      File and Print Server</span><br><span class="line">      Cinnamon Desktop</span><br><span class="line">      MATE Desktop</span><br><span class="line">      Basic Web Server</span><br><span class="line">      Virtualization Host</span><br><span class="line">      Server with GUI</span><br><span class="line">      GNOME Desktop</span><br><span class="line">      KDE Plasma Workspaces</span><br><span class="line">      Development and Creative Workstation</span><br><span class="line">      Available Groups:</span><br><span class="line">      Cinnamon</span><br><span class="line">      Compatibility Libraries</span><br><span class="line">      Console Internet Tools</span><br><span class="line">      Development Tools</span><br><span class="line">      Educational Software</span><br><span class="line">      Electronic Lab</span><br><span class="line">      Fedora Packager</span><br><span class="line">      General Purpose Desktop</span><br><span class="line">      Graphical Administration Tools</span><br><span class="line">      Haskell</span><br><span class="line">      Legacy UNIX Compatibility</span><br><span class="line">      MATE</span><br><span class="line">      Milkymist</span><br><span class="line">      Scientific Support</span><br><span class="line">      Security Tools</span><br><span class="line">      Smart Card Support</span><br><span class="line">      System Administration Tools</span><br><span class="line">      System Management</span><br><span class="line">      TurboGears application framework</span><br><span class="line">      Xfce</span><br><span class="line">      Done</span><br></pre></td></tr></table></figure>
<pre><code>- base: mirrors.aliyun.com
    - epel: mirrors.njupt.edu.cn
    - extras: mirrors.huaweicloud.com
    - updates: mirrors.huaweicloud.com
  Available Environment Groups:
  Minimal Install
  Compute Node
  Infrastructure Server
  File and Print Server
  Cinnamon Desktop
  MATE Desktop
  Basic Web Server
  Virtualization Host
  Server with GUI
  GNOME Desktop
  KDE Plasma Workspaces
  Development and Creative Workstation
  Available Groups:
  Cinnamon
  Compatibility Libraries
  Console Internet Tools
  Development Tools
  Educational Software
  Electronic Lab
  Fedora Packager
  General Purpose Desktop
  Graphical Administration Tools
  Haskell
  Legacy UNIX Compatibility
  MATE
  Milkymist
  Scientific Support
  Security Tools
  Smart Card Support
  System Administration Tools
  System Management
  TurboGears application framework
  Xfce
  Done
</code></pre><p><strong>注意：此例只是示例，只是表示可以这样使用，并不代表真的存在相关描述的软件包。因为从包组中查找安装软件包非常少用，几乎用不到。如果想安装某个软件包，可以使用yum list | grep “软件包名或通配”来完成。</strong></p>
<p><strong>至此，Linux常用的系统管理命令已经更新完毕，其实，在Linux系统管理中最常用的还是一些管理工具，会在Linux常用工具分类中系统管理工具有总体介绍。</strong></p>
<p><strong>随着Linux系统管理命令更新结束，Linux系统核心命令部分全部更新完毕，共分为10篇，约70-80个常用命令，与Linux系统总体命令600余个相比还差很远。但是，这些常用命令以及后续介绍常用工具是一个运维人员必须掌握的，至于其它命令和工具在实际中碰到了再查询使用帮助即可。</strong></p>

      
    </div>

    

    
    
    

    

    
      
    
	
	<div>
	
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
	
	</div>
	
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById(&quot;QR&quot;); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="kkutysllb 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="kkutysllb 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        



  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>kkutysllb</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="https://kkutysllb.cn/2019/05/27/2019-05-27-Linux系统命令-第十篇《系统管理命令》/" title="2019-05-27-Linux系统命令-第十篇《系统管理命令》">https://kkutysllb.cn/2019/05/27/2019-05-27-Linux系统命令-第十篇《系统管理命令》/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/25/2019-05-25-Linux系统命令-第九篇《网络管理命令》/" rel="next" title="2019-05-25-Linux系统命令-第九篇《网络管理命令》">
                <i class="fa fa-chevron-left"></i> 2019-05-25-Linux系统命令-第九篇《网络管理命令》
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/27/2019-05-27-存储虚拟化概述/" rel="prev" title="2019-05-27-存储虚拟化概述">
                2019-05-27-存储虚拟化概述 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MjY0Ni8xOTE5Mw=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="kkutysllb">
            
              <p class="site-author-name" itemprop="name">kkutysllb</p>
              <p class="site-description motion-element" itemprop="description">容易走的路是下坡路<br>总是不经意间装个X得罪一票人</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">48</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/kkutysllb" title="GitHub &rarr; https://github.com/kkutysllb" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:linbrid772233@gmail.com" title="E-Mail &rarr; mailto:linbrid772233@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-e-mail"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/u/2243838583?is_all=1" title="Weibo &rarr; https://weibo.com/u/2243838583?is_all=1" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.zhihu.com/people/tang-xi-yao-43/activities" title="Zhihu &rarr; https://www.zhihu.com/people/tang-xi-yao-43/activities" rel="noopener" target="_blank"><i class="fa fa-fw fa-zhihu"></i>Zhihu</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#lsof：查看进程打开的文件"><span class="nav-number">1.</span> <span class="nav-text">lsof：查看进程打开的文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#uptime：显示系统的运行时间及负载"><span class="nav-number">2.</span> <span class="nav-text">uptime：显示系统的运行时间及负载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#free：查看系统内存信息"><span class="nav-number">3.</span> <span class="nav-text">free：查看系统内存信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#iftop：动态显示网络接口流量信息"><span class="nav-number">4.</span> <span class="nav-text">iftop：动态显示网络接口流量信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vmstat：虚拟内存统计"><span class="nav-number">5.</span> <span class="nav-text">vmstat：虚拟内存统计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mpstat：CPU信息统计"><span class="nav-number">6.</span> <span class="nav-text">mpstat：CPU信息统计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#iostat：I-O信息统计"><span class="nav-number">7.</span> <span class="nav-text">iostat：I/O信息统计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#iotop：动态显示磁盘I-O统计信息"><span class="nav-number">8.</span> <span class="nav-text">iotop：动态显示磁盘I/O统计信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sar：收集系统信息"><span class="nav-number">9.</span> <span class="nav-text">sar：收集系统信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ntsysv：管理开机服务"><span class="nav-number">10.</span> <span class="nav-text">ntsysv：管理开机服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rpm：RPM包管理器"><span class="nav-number">11.</span> <span class="nav-text">rpm：RPM包管理器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#yum：自动化RPM包管理工具"><span class="nav-number">12.</span> <span class="nav-text">yum：自动化RPM包管理工具</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kkutysllb</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">564k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">8:33</span>
  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
  
  <script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.0"></script>

  <script src="/js/src/motion.js?v=7.0.0"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.0"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.0"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.0"></script>
<script src="/js/src/post-details.js?v=7.0.0"></script>



  


  <script src="/js/src/bootstrap.js?v=7.0.0"></script>



  


  
    <script>
  window.livereOptions = {
    refer: '2019/05/27/2019-05-27-Linux系统命令-第十篇《系统管理命令》/'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function(i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap');
      $(e).after($wrap);
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
        var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
          return $(e).text();
        }).toArray().join('\n');
        var ta = document.createElement('textarea');
        var range = document.createRange(); //For Chrome
        var sel = window.getSelection(); //For Chrome
        var yPosition = window.pageYOffset || document.documentElement.scrollTop;
        ta.style.top = yPosition + 'px'; //Prevent page scroll
        ta.style.position = 'absolute';
        ta.style.opacity = '0';
        ta.value = code;
        ta.textContent = code; //For FireFox
        ta.contentEditable = true;
        ta.readOnly = false;
        document.body.appendChild(ta);
        range.selectNode(ta);
        sel.removeAllRanges();
        sel.addRange(range);
        ta.setSelectionRange(0, code.length);
        var result = document.execCommand('copy');
        
          if (result) $(this).text('复制成功');
          else $(this).text('复制失败');
        
        ta.blur(); //For iOS
        $(this).blur();
      })).on('mouseleave', function(e) {
        var $b = $(this).find('.copy-btn');
        setTimeout(function() {
          $b.text('复制');
        }, 300);
      }).append(e);
    })
  </script>


</body>
</html>
